"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.spawnVBSbuffer = exports.spawnVBS = void 0;
const node_child_process_1 = require("node:child_process");
const spawnVBS = (cmd) => {
    const { command, args, options } = cmd;
    return new Promise((resolve) => {
        const child = (0, node_child_process_1.spawn)(command, args, Object.assign({ windowsHide: true, shell: true }, options));
        const result = [];
        child.stdout.on("data", (data) => {
            result.push(data);
        });
        child.on("close", () => {
            return resolve(result.join(""));
        });
    });
};
exports.spawnVBS = spawnVBS;
const spawnVBSbuffer = (cmd) => {
    const { command, args, options } = cmd;
    return new Promise((resolve) => {
        const child = (0, node_child_process_1.spawn)(command, args, Object.assign({ windowsHide: true, shell: true }, options));
        const result = [];
        child.stdout.on("data", (data) => {
            result.push(data);
        });
        child.on("close", () => {
            return resolve(result);
        });
    });
};
exports.spawnVBSbuffer = spawnVBSbuffer;
